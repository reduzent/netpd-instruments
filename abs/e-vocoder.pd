#N canvas 738 288 196 184 10;
#N canvas 680 22 450 300 \$2-e-vocoder-gui 0;
#X text 22 24 this is a port of the pdmtl fx.vocoder~ implemented for xi0n0ix. as far as i see there is no interesting parameter to control. therefore the gui is empty :);
#X text 26 103 mabye we should start a mtllib to port some more of these great abs?;
#X restore 21 20 pd \$2-e-vocoder-gui;
#N canvas 384 25 332 271 e-vocoder 0;
#X obj 59 69 r~ \$2-l;
#X obj -15 153 throw~ \$2-l;
#X obj 120 70 r~ \$2-r;
#X obj 119 154 throw~ \$2-r;
#N canvas 308 81 795 617 fft-analysis 0;
#X obj 94 511 *~;
#X obj 55 511 *~;
#X obj 413 356 *~;
#X obj 372 356 *~;
#X obj 372 379 +~;
#X obj 54 183 *~;
#X obj 54 158 inlet~;
#X obj 54 206 rfft~;
#X obj 54 560 *~;
#X obj 141 245 *~;
#X obj 372 333 rfft~;
#X obj 54 535 rifft~;
#X obj 54 583 outlet~;
#X obj 107 245 *~;
#X obj 107 268 +~;
#X text 458 408 modulus;
#X obj 107 420 *~;
#X obj 107 398 clip~;
#X obj 87 184 tabreceive~ \$0-hann;
#X obj 599 53 loadbang;
#X obj 148 346 r squelch;
#X obj 147 369 expr 0.01*$f1*$f1;
#X obj 107 294 +~ 1e-20;
#X obj 108 480 *~ 0.00065;
#X obj 87 560 tabreceive~ \$0-hann;
#X obj 373 307 *~;
#X obj 373 282 inlet~;
#X obj 406 308 tabreceive~ \$0-hann;
#X obj 107 321 q8_rsqrt~;
#X obj 372 402 q8_sqrt~;
#X text 458 425 of control;
#X text 456 442 amplitude;
#X text 196 248 reciprocal;
#X text 199 267 modulus of;
#X text 195 287 filter input;
#X text 196 306 amplitude;
#X text 115 159 filter input;
#X text 438 282 control source;
#X text 434 332 Fourier transform;
#X text 28 17 Internal workings of the timbre stamping algorithm. First the "filter input" is treated as in the compressor patch \, multiplying each channel amplitude by one over its modulus (but limited by the "squelch" parameter.) It is then multiplied by the modulus of the channel amplitude for the control source (which is Fourier analyzed in parallel with the filter input.);
#X text 145 422 multiply the two amplitude;
#X text 143 439 factors (for compression;
#X text 145 455 and to apply new timbre);
#X obj 598 7 inlet;
#X obj 598 29 switch~ 1024 4;
#X msg 599 76 \; window-size 1024 \; squelch 30 \;;
#X msg 549 68 1;
#X connect 0 0 11 1;
#X connect 1 0 11 0;
#X connect 2 0 4 1;
#X connect 3 0 4 0;
#X connect 4 0 29 0;
#X connect 5 0 7 0;
#X connect 6 0 5 0;
#X connect 7 0 13 0;
#X connect 7 0 13 1;
#X connect 7 0 1 0;
#X connect 7 1 9 0;
#X connect 7 1 9 1;
#X connect 7 1 0 0;
#X connect 8 0 12 0;
#X connect 9 0 14 1;
#X connect 10 0 3 0;
#X connect 10 0 3 1;
#X connect 10 1 2 0;
#X connect 10 1 2 1;
#X connect 11 0 8 0;
#X connect 13 0 14 0;
#X connect 14 0 22 0;
#X connect 16 0 23 0;
#X connect 17 0 16 0;
#X connect 18 0 5 1;
#X connect 19 0 45 0;
#X connect 19 0 46 0;
#X connect 20 0 21 0;
#X connect 21 0 17 2;
#X connect 22 0 28 0;
#X connect 23 0 0 1;
#X connect 23 0 1 1;
#X connect 24 0 8 1;
#X connect 25 0 10 0;
#X connect 26 0 25 0;
#X connect 27 0 25 1;
#X connect 28 0 17 0;
#X connect 29 0 16 1;
#X connect 43 0 44 0;
#X connect 46 0 44 0;
#X restore 17 100 pd fft-analysis;
#N canvas 0 110 565 454 hann-window 0;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-hann 1024 float 0;
#X coords 0 1 1023 0 300 100 1;
#X restore 82 311 graph;
#X obj 378 165 osc~;
#X obj 378 190 *~ -0.5;
#X obj 378 214 +~ 0.5;
#X obj 331 247 tabwrite~ \$0-hann;
#X obj 37 88 r window-size;
#X obj 38 173 /;
#X obj 127 142 samplerate~;
#X obj 38 251 s window-sec;
#X obj 177 204 swap;
#X obj 177 228 /;
#X obj 177 252 s window-hz;
#X obj 49 201 * 1000;
#X obj 49 228 s window-msec;
#X obj 38 115 t f b f;
#X msg 173 92 resize \$1;
#X obj 173 116 s \$0-hann;
#X obj 330 105 r window-hz;
#X msg 382 130 0;
#X obj 330 131 t f b;
#X text 15 8 calculate Hann window table (variable window size) and constants window-hz (fundamental frequency of analysis) \, window-sec and window-msec (analysis window size in seconds and msec).;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 4 0;
#X connect 5 0 14 0;
#X connect 6 0 8 0;
#X connect 6 0 12 0;
#X connect 7 0 6 1;
#X connect 7 0 9 1;
#X connect 9 0 10 0;
#X connect 9 1 10 1;
#X connect 10 0 11 0;
#X connect 12 0 13 0;
#X connect 14 0 6 0;
#X connect 14 0 9 0;
#X connect 14 1 7 0;
#X connect 14 2 15 0;
#X connect 15 0 16 0;
#X connect 17 0 19 0;
#X connect 18 0 1 1;
#X connect 19 0 1 0;
#X connect 19 1 4 0;
#X connect 19 1 18 0;
#X restore 136 97 pd hann-window;
#X text -28 12 port of pdmtl's fx.vocoder;
#N canvas 718 47 374 379 examplefilter 0;
#X obj 38 97 random 13;
#X obj 39 118 + 50;
#X obj 38 75 metro 1000;
#X msg 37 54 1;
#X obj 37 33 loadbang;
#X msg 67 53 0;
#N canvas 540 221 656 544 musical.closest.note 0;
#X obj 173 244 + 12;
#X obj 173 275 -;
#X obj 141 179 t b a;
#X obj 171 200 drip;
#X obj 122 108 t f b f b;
#X obj 359 20 inlet;
#X obj 297 163 f;
#X obj 177 326 min;
#X obj 207 350 f;
#X obj 143 385 f;
#X obj 122 60 inlet;
#X obj 122 417 +;
#X obj 122 449 outlet;
#X obj 301 263 f 12;
#X text 301 113 minimum ( Each of the notes in the scale - the current input note );
#X text 239 417 + the current input note;
#X text 47 491 Need abs() to make it more accurate (such as rint() but for floats);
#X text 317 298 Differences;
#X obj 218 449 outlet;
#X obj 173 223 expr fmod($f1 \, 12);
#X obj 171 299 expr fmod($f1 \, 12);
#X obj 297 186 expr fmod($f1 \, 12);
#X obj 141 154 list append 0 2 4 7 9;
#X connect 0 0 1 0;
#X connect 1 0 20 0;
#X connect 2 0 9 0;
#X connect 2 1 3 0;
#X connect 3 0 19 0;
#X connect 4 0 11 0;
#X connect 4 1 22 0;
#X connect 4 2 6 0;
#X connect 4 3 13 0;
#X connect 5 0 22 1;
#X connect 6 0 21 0;
#X connect 7 0 8 0;
#X connect 8 0 7 1;
#X connect 8 0 9 1;
#X connect 9 0 11 1;
#X connect 9 0 18 0;
#X connect 10 0 4 0;
#X connect 11 0 12 0;
#X connect 13 0 7 1;
#X connect 19 0 0 0;
#X connect 20 0 7 0;
#X connect 21 0 1 1;
#X connect 22 0 2 0;
#X restore 38 139 pd musical.closest.note;
#X obj 41 222 mtof;
#X obj 88 224 mtof;
#X obj 152 225 mtof;
#X obj 199 226 mtof;
#X obj 69 185 + 4;
#X obj 118 184 + 7;
#X obj 175 193 + 10;
#X obj 43 291 outlet~;
#X obj 41 258 nblsaw~;
#X obj 101 258 nblsaw~;
#X obj 161 258 nblsaw~;
#X obj 231 258 nblsaw~;
#X connect 0 0 1 0;
#X connect 1 0 6 0;
#X connect 2 0 0 0;
#X connect 3 0 2 0;
#X connect 4 0 3 0;
#X connect 5 0 2 0;
#X connect 6 0 7 0;
#X connect 6 0 11 0;
#X connect 6 0 12 0;
#X connect 6 0 13 0;
#X connect 7 0 15 0;
#X connect 8 0 16 0;
#X connect 9 0 17 0;
#X connect 10 0 18 0;
#X connect 11 0 8 0;
#X connect 12 0 9 0;
#X connect 13 0 10 0;
#X connect 15 0 14 0;
#X connect 16 0 14 0;
#X connect 17 0 14 0;
#X connect 18 0 14 0;
#X restore -12 43 pd examplefilter;
#N canvas 45 384 450 300 abslist 0;
#X msg 31 29 nblsaw~;
#X restore -9 193 pd abslist;
#X connect 0 0 4 1;
#X connect 2 0 4 1;
#X connect 4 0 1 0;
#X connect 4 0 3 0;
#X connect 7 0 4 0;
#X restore 21 50 pd e-vocoder;
#X msg 21 80 version 1.0.2;
